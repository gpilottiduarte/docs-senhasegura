<!-- ## Metadata_Start 
## code: pt
## title: Nova regra geral 
## slug: go-endpoint-manager-linux-policies-general 
## seoTitle: Nova regra geral 
## description:  
## contentType: Wysiwyg 
## Metadata_End -->
<h2>Cadastrar regra geral de política de acesso padrão</h2><section class="warningBox"><div class="title">Cuidado</div><div class="content"><div class="content">O senhasegura não concede permissão a um diretório ou arquivo para um usuário se o sistema operacional não permite o acesso.</div></div></section><ol><li>Acesse a plataforma senhasegura.</li><li>Acesse o menu <strong>GO Endpoint Manager➔Políticas➔Linux➔Políticas de acesso.</strong></li><li>Clique em <strong>⁝</strong> e selecione a opção <strong>Nova regra geral&nbsp;</strong>para criar uma política global.</li><li>No formulário <strong>Cadastro de política de acesso</strong> na aba <strong>Principal</strong>, preencha os campos:<ul><li><strong>Nome de identificação:</strong> defina um nome fácil de identificar. &nbsp;<strong>&nbsp;</strong></li><li><strong>Ativo:</strong> se ativa, a política será aplicada nos dispositivos.&nbsp;</li><li><strong>Diretriz:&nbsp;</strong>selecione um tipo de política.&nbsp;</li><li><strong>Verificador (path ou executor):&nbsp;</strong>preencha com o caminho do diretório, por exemplo: path="/usr/bin/ls" ou com o executor, por exemplo: exec="/usr/bin/ls".<br><section class="errorBox"><div class="title">Importante</div><div class="content">O não preenchimento ou o preenchimento incorreto deste campo pode levar a completa inutilização do dispositivo.<br>Siga a <a href="https://caitsith.osdn.jp/#syntax_list" rel="noopener noreferrer" target="_blank" translate="no">sintaxe do CaitSith</a> para preencher corretamente este campo.</div></section><div class="fr-inner content"><br></div></li><li><strong>Habilitar auditoria?:&nbsp;</strong>habilita a auditoria de ações da política. O campo é obrigatório e por padrão vem ativo.</li><li><strong>Incluir regra de negação geral?:&nbsp;</strong>permite apenas as regras cadastradas e nega o que não esta na regra.&nbsp;</li><li><strong>Permitir ou negar:</strong> preencha se a política cadastrada permite ou nega o acesso para o usuário ou grupo.</li><li><strong>Texto da regra:&nbsp;</strong>preencha com uma regra no formato das políticas no <a href="https://caitsith.osdn.jp/#syntax_list" rel="noopener noreferrer" target="_blank" translate="no">CaitSith</a>. Por exemplo, task.uid="user".<br><section class="warningBox"><div class="title">Cuidado</div><div class="content">A primeira regra adicionada tem prioridade sobre as regras adicionadas depois. Se você criar uma regra que permite a execução do binário e adicionar outra regra para bloquear a execução do mesmo binário, a primeira regra será considerada e a segunda não.</div></section><div class="fr-inner content"><br></div></li></ul></li><li>Clique em <strong>Adicionar.</strong></li><li>Clique em <strong>Salvar.</strong></li></ol><div class="content fr-inner">Todos os comandos que passarem por um processo de filtragem em que uma regra foi definida para permitir a execução dentro de políticas de acesso CaitSith ou regras Sudo serão registradas. Assim que o usuário executar qualquer comando que esteja nas políticas de acesso, o sistema iniciará automaticamente a gravação da sessão. Você pode selecionar alterar a regra geral de uma política para incluir o controle de diretórios e arquivos. Basta clicar no ícone localizado na coluna <strong>Ação</strong> de uma política já existente e alterar ou adicionar regras.</div><hr><h2>Cadastrar regra geral de política de acesso amigável</h2><p style="box-sizing: border-box; margin: 0px 0px 1rem; overflow-wrap: break-word; padding: 0px; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box; font-size: 16px;"></span></p><ol><li>Acesse a plataforma senhasegura.</li><li>Acesse o menu <strong>GO Endpoint Manager➔Políticas➔Linux➔Políticas de acesso.</strong></li><li>Clique em<strong>&nbsp;⁝</strong> e selecione a opção <strong>Nova regra geral</strong> para criar uma política global.</li><li>No formulário <strong>Cadastro de política de acesso</strong> na aba <strong>Aplicação</strong>, preencha os campos:<ul><li><strong>Nome de identificação:&nbsp;</strong>escolha um nome que será facilmente identificável.</li><li><strong>Ativo:</strong> se a opção Sim está selecionada, a política é considerada nos dispositivos alvo.</li><li><strong>Habilitar auditoria?:&nbsp;</strong>se a opção <strong>Sim</strong> está selecionada, ocorre a auditoria de ações que se enquadram nesta política. O campo é obrigatório e por padrão vem ativo.</li><li><strong>Habilitar gravação de sessão?:</strong> se a opção Sim está selecionada, ocorre a gravação da sessão dos binários registrados. O início da sessão é vinculado a execução do binário quando a execução é finalizada a gravação acaba.</li><li><strong>Incluir regra de negação geral?:</strong><strong>&nbsp;</strong>permite apenas as regras cadastradas e nega o que não esta na regra.&nbsp;</li><li><strong>Caminho do programa:</strong> o local do programa no sistema de arquivos. Por exemplo: /usr/bin/ls.</li><li><strong>O caminho é um link simbólico?:&nbsp;</strong>marque se este caminho adicionado é um link para um arquivo ou diretório.</li></ul></li><li>Clique em <strong>Adicionar.</strong><ul><li><strong>Permissão:</strong> escolha entre permitir ou bloquear, conforme a política que está sendo criada.</li><li><strong>Usuário ou grupo:</strong> adicione para quem esta regra vale, usuário ou grupo.</li><li><strong>Nome do usuário ou grupo:&nbsp;</strong>preencha com o nome do usuário ou grupo de acordo com o tipo escolhido no campo anterior.</li></ul></li><li>Clique em<strong>&nbsp;Adicionar.</strong></li><li>Clique em<strong>&nbsp;Salvar. &nbsp;</strong></li></ol><hr><h2>Cadastrar regra geral para controle de diretórios e arquivos</h2><ol><li>Acesse a plataforma senhasegura.</li><li>Acesse o menu <strong>GO Endpoint Manager➔Políticas➔Linux➔Políticas de acesso.</strong></li><li>Clique em <strong>⁝</strong> e selecione a opção <strong>Nova regra geral&nbsp;</strong>para criar uma política global.</li><li>No formulário <strong>Cadastro de política de acesso</strong> na aba <strong>Controle de diretórios e arquivos</strong>, preencha os campos:</li><li>No primeiro campo <strong style="box-sizing: border-box; font-weight: 700;">Permissão</strong>,<strong style="box-sizing: border-box; font-weight: 700;">&nbsp;</strong>selecione o que os usuários podem fazer:<ul><li><strong>Leitura:</strong> permite &nbsp;apenas ver e listar os arquivos e subarquivos/subdiretórios.</li><li><strong>Escrita:</strong> permite &nbsp;editar um arquivo ou modificar o conteúdo de um diretório.</li><li><strong>Execução:&nbsp;</strong>permite executar um arquivo ou acessar um diretório.</li></ul></li><li>No campo <strong>Diretório</strong> <strong>ou arquivo</strong>, indique o caminho completo do arquivo ou diretório que deseja controlar.</li><li>Clique no botão <strong>Adicionar</strong> para incluir a permissão para o controle.</li><li>Se desejar, realize os passos anteriores para adicionar mais arquivos e diretórios para serem controlados.</li><li>No campo <strong>Usuário</strong>, insira o nome do grupo de segurança do domínio ou o nome de usuário de um usuário local, ou de domínio.</li><li>No campo <strong>Regras de bloqueio</strong>, selecione o que os usuários <strong>não&nbsp;</strong>podem fazer:<ul><li><strong>Leitura:</strong> não permite ver e listar os arquivos e subarquivos/subdiretórios.</li><li><strong>Escrita:</strong> não permite editar um arquivo ou modificar o conteúdo de um diretório.</li><li><strong>Execução:&nbsp;</strong>não permite executar um arquivo ou acessar um diretório.</li></ul></li><li>No campo <strong>Diretório ou arquivo</strong> indique o caminho completo diretório que deseja que seja controlado.</li><li>Clique no botão <strong>Adicionar&nbsp;</strong>para incluir a permissão para o controle.</li><li>Se desejar, realize os passos anteriores para adicionar mais arquivos e diretórios para serem controlados.</li><li>Clique em<strong>&nbsp;Salvar.</strong></li></ol><hr><h2>Cadastrar regra geral para alias</h2><ol><li>Acesse a plataforma senhasegura.</li><li>Acesse o menu <strong>GO Endpoint Manager➔Políticas➔Linux➔Políticas de acesso.</strong></li><li>Clique em<strong>&nbsp;⁝</strong> e selecione a opção <strong>Nova regra geral</strong> para criar uma política global.</li><li>No formulário <strong>Cadastro de política de acesso</strong> na aba <strong>Alias</strong>, preencha os campos:</li><li>Ao criar uma <strong style="box-sizing: border-box; font-weight: 700;">Nova regra geral,</strong> a aba <strong style="box-sizing: border-box; font-weight: 700;">Alias&nbsp;</strong>permite a criação de alias (nomes alternativos para comandos) através do GO Endpoint Manger para Linux. Você pode criar atalhos para gerenciar os comandos que são mais usados e tenham um texto muito longo, agilizando a utilização do terminal.&nbsp;<ul><li><strong style="box-sizing: border-box; font-weight: 700;">Alias:</strong> preencha com o atalho ou apelido para comandos maiores.</li><li><strong style="box-sizing: border-box; font-weight: 700;">Comando:</strong> preencha com o comando que irá ser utilizado no terminal.</li></ul></li><li>Clique em<strong>&nbsp;Salvar.</strong></li></ol><hr><h2>Cadastrar regra geral para v<strong>ariáveis de ambiente</strong></h2><ol><li>Acesse a plataforma senhasegura.</li><li>Acesse o menu <strong>GO Endpoint Manager➔Políticas➔Linux➔Políticas de acesso.</strong></li><li>Clique em<strong>&nbsp;⁝</strong> e selecione a opção <strong>Nova regra geral</strong> para criar uma política global.</li><li>No formulário <strong>Cadastro de política de acesso</strong> na aba <strong>v</strong><strong>ariáveis de ambiente</strong>, preencha os campos:</li><li>As variáveis de ambinete podem ser usadas de maneira dinâmica para programas ou processos em execução no sistema.&nbsp;<ul><li><strong>Nome da variável:</strong> preencha com o nome da variável.</li><li><strong>Valor da variável:</strong> preencha com o valor da variável.</li></ul></li><li>Clique em<strong>&nbsp;Salvar.</strong></li></ol><hr><h2>Validar a política no dispositivo de destino</h2><p>Utilizando a política criada acima, visualize o arquivo /sys/kernel/security/caitsith/policy para verificar as regras <a href="https://caitsith.osdn.jp/" rel="nofollow noopener noreferrer" target="_blank" translate="no">CaitSith</a> padrão aplicadas ao dispositivo.</p><pre><code class="language-shell" data-code-id="section-1677102594695" data-language="shell">root\@debian:/root# cat /sys/kernel/security/caitsith/policy 
POLICY_VERSION = 20120401
stat Policy updated: 9036 (Last: 2019/12/24 00:31:57)
stat Requests denied: 10 (Last: 2019/12/23 18:55:22)
stat Memory used by policy: 4512
stat Memory used by audit: 63808
stat Memory used by query: 0
quota memory audit 16777216
quota memory query 1048576
quota audit \[1\] allowed = 0 denied = 1024 unmatched = 1024

**1**00 acl write path="/etc/oracle/tnsnames.ora"
audit 1
100 allow task.uid = 1002
200 deny </code></pre><p>O senhasegura identificou o 'uid' do usuário 'dba' utilizado na regra acima como 1002, criando a permissão '<span class="token number" style="box-sizing: border-box; color: rgb(153, 0, 85);">100</span> allow task.uid <span class="token operator" style="box-sizing: border-box; color: rgb(154, 110, 58); background: rgba(255, 255, 255, 0.5);">=&nbsp;</span><span class="token number" style="box-sizing: border-box; color: rgb(153, 0, 85);">1002'.</span></p><p>Conforme a regra aplicada acima, o usuário dba consegue inserir um conteúdo no arquivo alvo.&nbsp;</p><div class="fr-img-space-wrap"><span class="fr-img-caption fr-fic fr-dib" style="width: 563px;"><span class="fr-img-wrap"><img src="https://cdn.document360.io/5a1d58df-64ce-42a2-8b23-688477d32f33/Images/Documentation/image-1677103618020.png" class="fr-fic fr-fil fr-dib" style="width: 563px;"><span class="fr-inner" data-gramm="false" data-lt-tmp-id="lt-424026" spellcheck="true">O usuário dba consegue escrever no arquivo&nbsp;</span></span></span></div><div><p>O super-usuário não consegue escrever no arquivo, uma vez que este usuário está na regra de negação da diretiva criada. Mesmo sendo um super-usuário, a tentativa de escrita não é possível.</p><p><span style="font-size: 14px;"></span></p></div><div><span><span class="fr-img-wrap" style="box-sizing: border-box; padding: 0px; margin: auto; text-align: center; width: 100%;"><div class="fr-img-space-wrap"><span class="fr-img-caption fr-fic fr-dii fr-shadow" style="width: 554px;"><span class="fr-img-wrap"><img src="https://cdn.document360.io/5a1d58df-64ce-42a2-8b23-688477d32f33/Images/Documentation/image%28159%29.png" alt="image.png" class="fr-fic fr-dii fr-shadow" style="box-sizing: border-box; vertical-align: bottom; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: calc(100% - 10px); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 23px; display: block; float: none; margin: auto; width: 554px;"><span class="fr-inner" data-gramm="false" data-lt-tmp-id="lt-660347" spellcheck="false">O usuário root não consegue escrever no arquivo&nbsp;</span></span></span>&nbsp;</div></span></span></div><hr><div class="fr-img-space-wrap"><h2>Casos de uso</h2><h3>Negar a todos os usuários, exceto um único usuário, a execução de qualquer binário</h3><p>Esta política bloqueará qualquer usuário, exceto o <strong>adminlinux</strong>, de executar o vim.</p><p>1. Vá para <strong>Go Endpoint Manager ➔ Políticas ➔ Linux ➔ Políticas de acesso</strong></p><p>2. Clique em ⁝ e <strong>N</strong><strong>ova regra geral</strong></p><p>3. Preencha os campos na aba <strong>Principal</strong>:</p><ul style="list-style-type: disc;"><li><strong>Diretriz:</strong> selecione a opção <strong>Executar binário.</strong></li><li><strong>Verificador:</strong> path="/usr/bin/vim" (aqui pode ser qualquer outro binário que você deseja criar regras).</li><li><strong>Incluir regra de negação geral?:&nbsp;</strong>selecione.</li><li><strong>Permitir ou bloquear:</strong> defina como <strong>Permitir</strong>.</li><li><strong>Texto da regra:</strong> task.uid="adminlinux".</li></ul><p>4. Clique em <strong>Adicionar</strong></p><p>5. Clique em <strong>Salvar</strong></p><p><img src="https://cdn.document360.io/5a1d58df-64ce-42a2-8b23-688477d32f33/Images/Documentation/image-1668628314526.png" class="fr-fic fr-fil fr-dib fr-shadow"></p></div><hr><h3>Impedir o usuário 'JoãoS' de criar arquivos em um diretório especificado</h3><p>Esta política não permite que o usuário 'JoãoS' crie arquivos.</p><p>1. Vá para <strong>Go Endpoint Manager ➔ Políticas ➔ Linux ➔ Políticas de acesso</strong></p><p>2. Clique em ⁝ e <strong>N</strong><strong>ova regra geral</strong></p><p>3. Preencha os campos na aba <strong>Principal</strong>:</p><ul style="list-style-type: disc;"><li><strong>Diretriz:</strong> selecione a opção <strong>Criar arquivo.</strong></li><li><strong>Verificador (caminho ou executor):</strong> path="/usr/mydir"(aqui pode ser qualquer outro diretório que você deseja criar regras).</li><li><strong>Incluir regra de negação geral?</strong><strong>:</strong> não selecione.</li><li><strong>Permitir ou bloquear:</strong> defina como <strong>Bloquear.</strong></li><li><strong>Texto da regra:</strong> task.uid="JoãoS".</li></ul><p>4. Clique em <strong>Adicionar</strong></p><ul><li><strong>Permitir ou bloquear:</strong> defina como <strong>Permitir</strong></li><li><strong>Texto da regra:</strong> task.gid="meugrupo"</li></ul><p>5. Clique em <strong>Adicionar</strong></p><p>6. Clique em <strong>Salvar</strong></p><p><strong><img src="https://cdn.document360.io/5a1d58df-64ce-42a2-8b23-688477d32f33/Images/Documentation/image-1668629194317.png" class="fr-fic fr-fil fr-dib"></strong></p><section class="warningBox"><div class="title">Cuidado</div><div class="content">Certifique-se de deixar a regra 'JoãoS' acima da regra 'meu grupo'. Se 'JoãoS'<span style="color: rgb(127, 100, 22); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(253, 242, 206); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;"></span> estiver abaixo, não será possível bloqueá-lo porque a ordem das regras sempre prioriza a regra localizada no topo.</div></section><hr><h3>O usuário "JoãoS" e todos no "meugrupo" podem editar o arquivo sudoers</h3><p>1. Vá para <strong>Go Endpoint Manager ➔ Políticas ➔ Linux ➔ Políticas de acesso</strong></p><p>2. Clique em ⁝ e <strong>nova regra geral</strong></p><p>3. Preencha os campos na aba <strong>Principal</strong>:</p><ul style="list-style-type: disc;"><li><strong>Diretriz:</strong> selecione a opção <strong>Escrever</strong><strong>&nbsp;arquivo.</strong></li><li><strong>Verificador (caminho ou executor):&nbsp;</strong>path="/etc/sudoers/sudoers" (aqui pode ser qualquer outro arquivo que você deseja criar regras).</li><li><strong>Incluir regra de negação geral?</strong><strong>:</strong> selecione.</li><li><strong>Permitir ou bloquear:</strong> defina como <strong>Permitir.</strong></li><li><strong>Texto da regra:&nbsp;</strong>task.gid="meugrupo".</li></ul><p>4. Clique em <strong>Adicionar</strong></p><ul><li><strong>Permitir ou bloquear:</strong> defina como <strong>Permitir.</strong></li><li><strong>Texto da regra:</strong> task.uid="JoãoS".</li></ul><p>5. Clique em <strong>Adicionar</strong></p><p>6. Clique em <strong>Salvar</strong></p><p><img src="https://cdn.document360.io/5a1d58df-64ce-42a2-8b23-688477d32f33/Images/Documentation/image-1668630281472.png" class="fr-fic fr-fil fr-dib"></p><hr><h3>O usuário 'JoãoS' e todos no grupo "meugrupo" só podem ler o arquivo sudoers</h3><p>1. Vá para <strong>Go Endpoint Manager ➔ Políticas ➔ Linux ➔ Políticas de acesso</strong></p><p>2. Clique em ⁝ e <strong>nova regra geral</strong></p><p>3. Preencha os campos na aba <strong>Principal</strong>:</p><ul style="list-style-type: disc;"><li><strong>Diretriz:</strong> selecione a opção <strong>Le</strong>r<strong>&nbsp;arquivo.</strong></li><li><strong>Verificador (caminho ou executor):&nbsp;</strong>path="/etc/sudoers/sudoers" (aqui pode ser qualquer outro arquivo que você deseja criar regras).</li><li><strong>Incluir regra de negação geral?</strong><strong>:</strong> selecione.</li><li><strong>Permitir ou bloquear:</strong> defina como <strong>Permitir.</strong></li><li><strong>Texto da regra:&nbsp;</strong>task.gid="meugrupo". &nbsp;</li></ul><p>4. Clique em <strong>Adicionar</strong></p><ul><li><strong>Permitir ou bloquear:</strong> defina como <strong>Permitir.</strong></li><li><strong>Texto da regra:</strong> task.uid="JoãoS".</li></ul><p>5. Clique em <strong>Adicionar</strong></p><p>6. Clique em <strong>Salvar</strong></p><p><img src="https://cdn.document360.io/5a1d58df-64ce-42a2-8b23-688477d32f33/Images/Documentation/image-1668630659369.png" class="fr-fic fr-fil fr-dib"></p><hr><h3>Comando 'ls' só pode ser executado através do sudo</h3><p>1. Vá para <strong>Go Endpoint Manager ➔ Políticas ➔ Linux ➔ Políticas de acesso</strong></p><p>2. Clique em <strong>⁝</strong> e <strong>nova regra geral</strong></p><p>3. Preencha os campos na aba <strong>Principal</strong>:</p><ul style="list-style-type: disc;"><li><strong>Diretriz:</strong> selecione a opção <strong>Executar binário.</strong></li><li><strong>Verificador (caminho ou executor):&nbsp;</strong>exec="/usr/bin/ls"</li><li><strong>Incluir regra de negação geral?:</strong> selecione.</li><li><strong>Permitir ou bloquear:</strong> defina como <strong>Permitir.</strong></li><li><strong>Texto da regra:&nbsp;</strong>task.exe="/usr/bin/sudo".</li></ul><p>4. Clique em <strong>Adicionar</strong></p><p>5. Clique em <strong>Salvar</strong></p><p><img src="https://cdn.document360.io/5a1d58df-64ce-42a2-8b23-688477d32f33/Images/Documentation/image-1668630879369.png" class="fr-fic fr-fil fr-dib" style="box-sizing: border-box; vertical-align: top; border-style: none; cursor: pointer; padding: 0px 1px; position: relative; max-width: 100%; margin: 5px auto 5px 0px; display: block; float: none; text-align: left; color: rgb(34, 34, 34); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.48px; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><br></p><h2><br></h2><p><br></p><p><br class="Apple-interchange-newline"><br></p>